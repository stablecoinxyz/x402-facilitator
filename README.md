# x402-facilitator

SBC x402 Facilitator - Verify and Settle Payments.

This implementation supports **v1** of the x402 protocol.

## Installation

1. Clone the repository.
2. Install dependencies:
   ```bash
   npm install
   ```
3. Create a `.env` file based on your configuration requirements (check source code for needed variables).

## Usage

### Quick Demo (Base Sepolia)

We have provided a complete demo environment that runs on Base Sepolia using [SBC](https://sepolia.basescan.org/address/0xf9FB20B8E097904f0aB7d12e9DbeE88f2dcd0F16).

1.  **Setup the environment:**
    This script will generate EVM wallets for Client, Merchant, and Facilitator.
    It will check for:
    *   **ETH Balance (Gas):** If low, it provides faucet links (e.g., Coinbase).
    *   **SBC Balance (Payment):** If low, it provides the [SBC Faucet link](https://dashboard.stablecoin.xyz/faucet).
    
    Once funded, it will approve the Facilitator to spend the Client's SBC tokens.
    ```bash
    npm run setup
    ```

2.  **Start the server** (Terminal 1):
    Open a new terminal window/tab and run:
    ```bash
    npm run dev
    ```
    *Keep this terminal running. It listens for requests.*

3.  **Run the demo client** (Terminal 2):
    Open a **second** terminal window/tab and run:
    ```bash
    npm run demo
    ```

    The demo client sends a payment request to the running facilitator server. The facilitator then:
    1.  Verifies the EIP-712 signature and SBC balance.
    2.  Executes the settlement (transfers SBC from Client to Merchant).
    3.  Returns the transaction hash (viewable on BaseScan).

### Configuration

Configuration is handled via `.env`. A default `.env` is generated by `npm run setup`.

### Production

Build the project:
```bash
npm run build
```

Start the production server:
```bash
npm start
```

### Testing

Run tests:
```bash
npm test
```
